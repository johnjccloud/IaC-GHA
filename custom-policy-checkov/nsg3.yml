---
metadata:
  name: "Disallow 'Any', 'VirtualNetwork', or 'Internet' as source address in inbound NSG rules"
  id: "CKV_CUSTOM_3"
  category: "Infrastructure as Code"
  severity: "CRITICAL"
definition:
  not:
    and:  
       - cond_type: "attribute"
        resource_types:
          - "azurerm_network_security_rule"
        attribute: "destination_port_range"
        operator: "equals"
          value: "23"     
      - or:
          - cond_type: "attribute"
            resource_types:
              - "azurerm_network_security_rule"
            attribute: "source_address_prefix"
            operator: "equals"
            value: "*"
          - cond_type: "attribute"
            resource_types:
              - "azurerm_network_security_rule"
            attribute: "source_address_prefix"
            operator: "equals"
            value: "Internet"
          - cond_type: "attribute"
            resource_types:
              - "azurerm_network_security_rule"
            attribute: "source_address_prefix"
            operator: "equals"
            value: "0.0.0.0/0"
