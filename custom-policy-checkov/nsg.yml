---
metadata:
  name: "Disallow 'Any', 'VirtualNetwork', or 'Internet' as source address in inbound NSG rules"
  id: "CKV2_CUSTOM_1"
  category: "Infrastructure as Code"
  severity: "CRITICAL"
definition:
  not:
    or:
      - cond_type: "attribute"
        resource_types:
          - "aazurerm_network_security_rule"
        attribute: "source_address_prefix"
        operator: "equals"
        value: "*"
      - cond_type: "attribute"
        resource_types:
          - "azurerm_network_security_rule"
        attribute: "source_address_prefix"
        operator: "equals"
        value: "VirtualNetwork"    
      - cond_type: "attribute"
        resource_types:
          - "azurerm_network_security_rule"
        attribute: "source_address_prefix"
        operator: "equals"
        value: "Internet"
      - cond_type: "attribute"
        resource_types:
          - "azurerm_network_security_rule"
        attribute: "source_address_prefix"
        operator: "equals"
        value: "0.0.0.0/0"
        resource_types: 
        - "azurerm_network_security_group"
        attribute: "source_address_prefix"
        operator: "equals"
        value: "10.0.0.0/8"        